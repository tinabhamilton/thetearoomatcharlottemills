if (self.CavalryLogger) { CavalryLogger.start_js(["s3I5x"]); }

__d("ChatReliabilityEvents",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ERROR:"error",CHANNEL_DISCONNECT:"channel_disconnect",CHANNEL_CONNECT:"channel_connect",CHANNEL_INIT:"channel_init",CHANNEL_NOCONFIG:"channel_noconfig",CHANNEL_HISTORY_INVALID:"channel_history_invalid",CHANNEL_STALLED:"channel_stalled",MESSAGE_RECEIVED:"msg_received"};},null);
__d("StickerConstants",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120};},null);
__d('AvailableListConstants',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={ON_AVAILABILITY_CHANGED:'buddylist/availability-changed',ON_UPDATE_ERROR:'buddylist/update-error',ON_UPDATED:'buddylist/updated',ON_CHAT_NOTIFICATION_CHANGED:'chat-notification-changed',OFFLINE:0,IDLE:1,ACTIVE:2,MOBILE:3,WEB_STATUS:'webStatus',FB_APP_STATUS:'fbAppStatus',MESSENGER_STATUS:'messengerStatus',OTHER_STATUS:'otherStatus',STATUS_ACTIVE:'active',STATUS_IDLE:'idle',STATUS_OFFLINE:'offline'};f.exports=h;},null);
__d('LastActiveTimes',['fbt','ServerTime'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={};function j(n){if(!n||n<0)return '';var o=c('ServerTime').get()/1000-n,p=Math.floor(o/60),q=Math.floor(p/60),r=Math.floor(q/24);if(p<=1){return h._("{count}m",[h.param('count',1)]);}else if(p<60){return h._("{count}m",[h.param('count',p)]);}else if(q<24){return h._("{count}h",[h.param('count',q)]);}else if(r<3){return h._("{count}d",[h.param('count',r)]);}else return '';}function k(n,o){if(!(n in i)||i[n]<o)i[n]=o;}function l(n){if(n in i){return i[n];}else return 0;}var m={update:function(n){for(var o in n)k(o,n[o]);},getShortDisplay:function(n){return j(l(n));},get:function(n){return l(n);},getDebugData:function(){return i;}};f.exports=m;},null);
__d('PresenceUtil',['CurrentUser','randomInt'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('randomInt')(0,4294967295)+1;function i(){return h;}function j(){return c('CurrentUser').isLoggedInNow();}f.exports={getSessionID:i,hasUserCookie:j};},null);
__d('PresencePrivacy',['Arbiter','AsyncRequest','ChannelConstants','CurrentUser','PresencePrivacyInitialData','JSLogger','PresenceUtil'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='/ajax/chat/privacy/settings.php',i='/ajax/chat/privacy/online_policy.php',j='/ajax/chat/privacy/visibility.php',k='friend_visibility',l='visibility',m='online_policy',n=babelHelpers['extends']({},c('PresencePrivacyInitialData').privacyData),o=c('PresencePrivacyInitialData').visibility,p=babelHelpers['extends']({},c('PresencePrivacyInitialData').privacyData),q=o,r=c('PresencePrivacyInitialData').onlinePolicy,s=r,t=[],u=false;function v(){return c('JSLogger').create('blackbird');}var w=Object.assign(new (c('Arbiter'))(),{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1});function x(ja){var ka;for(ka in ja){var la=ja[ka];if(ka==c('CurrentUser').getID()){v().error('set_viewer_visibility');throw new Error("Invalid to set current user's visibility");}switch(la){case w.WHITELISTED:case w.BLACKLISTED:case w.UNLISTED:break;default:v().error('set_invalid_friend_visibility',{id:ka,value:la});throw new Error("Invalid state: "+la);}}for(ka in ja)n[ka]=ja[ka];w.inform('privacy-changed');}function y(ja,ka){var la={};la[ja]=ka;x(la);}function z(ja){switch(ja){case w.ONLINE:case w.OFFLINE:break;default:v().error('set_invalid_visibility',{value:ja});throw new Error("Invalid visibility: "+ja);}o=ja;w.inform('privacy-changed');w.inform('privacy-user-presence-changed');}function aa(ja){switch(ja){case w.ONLINE_TO_WHITELIST:case w.ONLINE_TO_BLACKLIST:break;default:throw new Error("Invalid default online policy: "+ja);}r=ja;w.inform('privacy-user-presence-changed');w.inform('privacy-changed');}function ba(ja,ka){u=true;ja.send();}function ca(ja,ka){t.push({request:ja,data:ka});if(!u){var la=t.shift();ba(la.request,la.data);}}function da(ja,ka){var la=ja.type;if(la===k){w.inform('privacy-availability-changed');for(var ma in ja.settings)p[ma]=ja.settings[ma];}else{if(la===l){q=ja.visibility;}else if(la===m)s=ja.online_policy;w.inform('privacy-user-presence-response');}v().log('set_update_response',{data:ja,response:ka});}function ea(ja,ka){if(o!==q)z(q);if(r!==s)aa(s);Object.assign(n,p);w.inform('privacy-changed');t=[];v().log('set_error_response',{data:ja,response:ka});}function fa(ja){u=false;if(t.length>0){var ka=t.shift();ba(ka.request,ka.data);}}function ga(ja,ka){if(c('PresenceUtil')!=null){var la=ja.getData();la.window_id=c('PresenceUtil').getSessionID();ja.setData(la);}ja.setHandler(da.bind(this,ka)).setErrorHandler(ea.bind(this,ka)).setTransportErrorHandler(ea.bind(this,ka)).setFinallyHandler(fa.bind(this)).setAllowCrossPageTransition(true);return ja;}function ha(ja,ka,la){return ga(new (c('AsyncRequest'))(ja).setData(ka),la);}function ia(ja,ka){var la=ka.obj;if(la.viewer_id!=c('CurrentUser').getID()){v().error('invalid_viewer_for_channel_message',{type:ja,data:ka});throw new Error("Viewer got from the channel is not the real viewer");}if(la.window_id===c('PresenceUtil').getSessionID())return;var ma=la.data;if(la.event=='access_control_entry'){ma.target_ids.forEach(function(oa){y(oa,ma.setting);p[oa]=ma.setting;});}else{if(la.event=='visibility_update'){var na=!!ma.visibility?w.ONLINE:w.OFFLINE;z(na);q=na;}else if(la.event=='online_policy_update'){aa(ma.online_policy);s=ma.online_policy;}w.inform('privacy-user-presence-response');}v().log('channel_message_received',{data:ka.obj});}Object.assign(w,{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1,init:function(ja,ka,la){},setVisibility:function(ja){q=o;z(ja);var ka={visibility:ja},la={type:l,visibility:ja},ma=ha(j,ka,la);ca(ma,la);v().log('set_visibility',{data:ka});return ja;},getVisibility:function(){return o;},setOnlinePolicy:function(ja){s=r;aa(ja);var ka={online_policy:ja},la={type:m,online_policy:ja},ma=ha(i,ka,la);ca(ma,la);v().log('set_online_policy',{data:ka});return ja;},getOnlinePolicy:function(){return r;},getFriendVisibility:function(ja){return n[ja]||w.UNLISTED;},isUserOffline:function(){return this.getVisibility()===w.OFFLINE;},allows:function(ja){if(this.isUserOffline())return false;var ka=this.getOnlinePolicy();return ka===w.ONLINE_TO_WHITELIST?n[ja]==w.WHITELISTED:n[ja]!=w.BLACKLISTED;},setFriendsVisibility:function(ja,ka){if(ja.length>0){var la={};for(var ma=0;ma<ja.length;ma++){var na=ja[ma];p[na]=n[na];la[na]=ka;}x(la);var oa=ka;if(oa==w.UNLISTED)oa=p[ja[0]];var pa={users:ja,setting:ka,setting_type:oa},qa={type:k,settings:la},ra=ha(h,pa,qa);ca(ra,qa);v().log('set_friend_visibility',{data:pa});}return ka;},setFriendVisibilityMap:function(ja,ka){for(var la in ja)p[la]=n[la];x(ja);var ma={type:k,settings:ja};ca(ga(ka,ma),ma);v().log('set_friend_visibility_from_map',{data:ja});},allow:function(ja){if(this.allows(ja)){v().error('allow_already_allowed');throw new Error("allow() should only be called for users that "+"are not already allowed");}if(this.getVisibility()===w.OFFLINE){v().error('allow_called_while_offline');throw new Error("allow() should only be called when the user is already online");}var ka=this.getOnlinePolicy()===w.ONLINE_TO_WHITELIST?w.WHITELISTED:w.UNLISTED;return this.setFriendsVisibility([ja],ka);},disallow:function(ja){if(!this.allows(ja)){v().error('disallow_already_disallowed');throw new Error("disallow() should only be called for users that "+"are not already disallowed");}if(this.getVisibility()===w.OFFLINE){v().error('disallow_called_while_offline');throw new Error("disallow() should only be called when the user is already online");}var ka=this.getOnlinePolicy()===w.ONLINE_TO_BLACKLIST?w.BLACKLISTED:w.UNLISTED;return this.setFriendsVisibility([ja],ka);},getBlacklist:function(){var ja=[];for(var ka in n)if(n[ka]===w.BLACKLISTED)ja.push(ka);return ja;},getWhitelist:function(){var ja=[];for(var ka in n)if(n[ka]===w.WHITELISTED)ja.push(ka);return ja;},getMapForTest:function(){return n;},setMapForTest:function(ja){n=ja;}});w.inform('privacy-changed');w.inform('privacy-user-presence-changed',c('Arbiter').BEHAVIOR_STATE);v().log('initialized',{visibility:o,policy:r});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ja,ka){ka.presence_privacy={initial:c('PresencePrivacyInitialData').privacyData,current:n};});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('privacy_changed'),ia.bind(this));c('Arbiter').subscribe(c('ChannelConstants').ON_CONFIG,function(ja,ka){var la=ka.getConfig('visibility',null);if(la!==null&&typeof la!=='undefined'){var ma=la?w.ONLINE:w.OFFLINE;z(ma);v().log('config_visibility',{vis:ma});}}.bind(this));f.exports=w;},null);
__d('ChatVisibility',['Arbiter','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={isOnline:function(){return c('PresencePrivacy').getVisibility()===c('PresencePrivacy').ONLINE;},hasBlackbirdEnabled:function(){return this.isVisibleToMostFriends()||this.isVisibleToSomeFriends();},isVisibleToMostFriends:function(){return c('PresencePrivacy').getOnlinePolicy()===c('PresencePrivacy').ONLINE_TO_BLACKLIST&&c('PresencePrivacy').getBlacklist().length>0;},isVisibleToSomeFriends:function(){return c('PresencePrivacy').getOnlinePolicy()===c('PresencePrivacy').ONLINE_TO_WHITELIST&&c('PresencePrivacy').getWhitelist().length>0;},goOnline:function(i){if(c('PresencePrivacy').getVisibility()===c('PresencePrivacy').OFFLINE){c('JSLogger').create('blackbird').log('chat_go_online');c('PresencePrivacy').setVisibility(c('PresencePrivacy').ONLINE);c('Arbiter').inform('chat-visibility/go-online');}i&&i();},goOffline:function(i){if(c('PresencePrivacy').getVisibility()===c('PresencePrivacy').ONLINE){c('JSLogger').create('blackbird').log('chat_go_offline');c('PresencePrivacy').setVisibility(c('PresencePrivacy').OFFLINE);c('Arbiter').inform('chat-visibility/go-offline');}i&&i();},toggleVisibility:function(){if(h.isOnline()){h.goOffline();}else h.goOnline();}};f.exports=h;},null);
__d('PresenceStatus',['ArbiterMixin','AvailableListConstants','BanzaiODS','ChatVisibility','CurrentUser','LastActiveTimes','PresencePrivacy','ServerTime','createObjectFrom','debounceAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();c('BanzaiODS').setEntitySample('presence',.0001);var h={},i={},j={},k=Object.assign({},c('ArbiterMixin')),l=c('debounceAcrossTransitions')(function(){return k.inform('change');},0);Object.assign(k,{resetPresenceData:function(){h={};i={};},reset:function(){k.resetPresenceData();j={};},get:function(m){if(m==c('CurrentUser').getID())return c('ChatVisibility').isOnline()?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;var n=c('AvailableListConstants').OFFLINE;if(m in h)n=h[m];if(!c('PresencePrivacy').allows(m))n=c('AvailableListConstants').OFFLINE;return n;},getCapabilities:function(m){var n=k.get(m);if(n==c('AvailableListConstants').OFFLINE)return 0;var o=i[m];return o?o:0;},isPlayingCanvasGameUser:function(m){return !!j[m];},getGroup:function(m){return m.some(function(n){if(n==c('CurrentUser').getID())return false;return k.get(n)===c('AvailableListConstants').ACTIVE;})?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;},set:function(m,n,o,p,q,r){if(m==c('CurrentUser').getID())return false;var s;if(n!==null&&n!==undefined){n=n==c('AvailableListConstants').ACTIVE?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;var t=k.get(m);s=t!=n;if(s&&t==c('AvailableListConstants').ACTIVE||n==c('AvailableListConstants').ACTIVE){var u={};u[m]=c('ServerTime').get()/1000;c('LastActiveTimes').update(u);}h[m]=n;}var v=false;if(q){v=k.getCapabilities(m)!=q;i[m]=q;}var w=s||v;if(w&&!r)l();return w;},setPlayingCanvasGameFriends:function(m){j=c('createObjectFrom')(m);},getOnlineIDs:function(){var m,n=[];for(m in h)if(k.get(m)===c('AvailableListConstants').ACTIVE)n.push(m);return n;},getOnlineCount:function(){return k.getOnlineIDs().length;},getPresenceStats:function(){var m=0,n=0,o=0;for(var p in h){m+=1;switch(k.get(p)){case c('AvailableListConstants').OFFLINE:n+=1;break;case c('AvailableListConstants').ACTIVE:o+=1;break;default:break;}}return {total:m,offline:n,active:o};},getDebugInfo:function(m){return {id:m,presence:h[m]};},getAllDebugInfo:function(){var m={};for(var n in h)m[n]={p:h[n],vc:i[n]};return m;},setMulti:function(m,n){var o=false;for(var p in m)k.set(p,m[p].a,false,n,m[p].c,true)&&(o=true);if(o)l();},setMultiChatproxy:function(m){var n={};for(var o in m){if(m[o].lat)n[o]=m[o].lat;var p=m[o].p;if(p!==undefined)k.set(o,p,false,'chatproxy',m[o].vc,true);}c('LastActiveTimes').update(n);l();},setMultiActive:function(m,n){var o=false;m.forEach(function(p){k.set(p,c('AvailableListConstants').ACTIVE,false,n,null,true)&&(o=true);});if(o)l();}});f.exports=k;},null);
__d('ChatproxyPresence',['Arbiter','AvailableListConstants','AvailableListInitialData','ChannelConstants','CurrentUser','LastActiveTimes','PresenceStatus','BanzaiODS','debounceAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.$ChatproxyPresence1=i;this.$ChatproxyPresence2=false;this.$ChatproxyPresence3=c('AvailableListInitialData').chatNotif;this.$ChatproxyPresence4=false;var j=c('AvailableListInitialData').activeList,k=c('AvailableListInitialData').lastActiveTimes;if(j)c('PresenceStatus').setMultiActive(j,'available_list_active');if(k&&!Array.isArray(k))c('LastActiveTimes').update(k);}h.prototype.subscribe=function(){'use strict';c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('chatproxy-presence'),this.updatePresenceInfo.bind(this));c('Arbiter').subscribe(c('ChannelConstants').ON_INVALID_HISTORY,function(){this.$ChatproxyPresence2=true;}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').RTI_SESSION,function(i,j){if(j)this.$ChatproxyPresence4=j;}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('get_debug_presence'),function(i,j){var k=c('PresenceStatus').getAllDebugInfo(),l=c('LastActiveTimes').getDebugData();for(var m in l){var n=k[m];if(n===undefined){n={};k[m]=n;}n.l=Math.floor(l[m]);}this.$ChatproxyPresence4.issueRequest('/debug_presence',{},k,function(){c('BanzaiODS').bumpEntityKey('ChatproxyPresence','debug_presence.sucess');});}.bind(this));};h.prototype.getRTISession=function(){'use strict';return this.$ChatproxyPresence4;};h.prototype.updatePresenceInfo=function(i,j){'use strict';if(this.$ChatproxyPresence2){this.$ChatproxyPresence2=false;c('PresenceStatus').resetPresenceData();}j=j.obj;var k=j.buddyList;c('PresenceStatus').setMultiChatproxy(k);var l=false;if(j.chatNotif!==undefined)l=this.$ChatproxyPresence3!==j.chatNotif;if(l)this.$ChatproxyPresence3=j.chatNotif;if(j.gamers)c('PresenceStatus').setPlayingCanvasGameFriends(j.gamers);if(l)this.$ChatproxyPresence1(c('AvailableListConstants').ON_CHAT_NOTIFICATION_CHANGED,this.$ChatproxyPresence3);c('debounceAcrossTransitions')(function(){this.$ChatproxyPresence1(c('AvailableListConstants').ON_AVAILABILITY_CHANGED);}.bind(this),0)();};h.prototype.getWebChatNotification=function(){'use strict';return this.$ChatproxyPresence3;};f.exports=h;},null);
__d('ChatConfig',['ChatConfigInitialData'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i={get:function(j,k){return j in h?h[j]:k;},set:function(j){if(arguments.length>1){var k={};k[j]=arguments[1];j=k;}Object.assign(h,j);},getDebugInfo:function(){return h;}};i.set(c('ChatConfigInitialData'));f.exports=i;},null);
__d('ExplicitRegistrationDispatcherUtils',['ErrorUtils','FluxInternalConfig','emptyFunction','monitorCodeUse','setImmediate'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('emptyFunction'),i=false,j=c('emptyFunction');f.exports={guessStoreName:h,warn:j,inlineRequiresEnabled:i};},null);
__d('ExplicitRegistrationDispatcher',['Dispatcher_DEPRECATED','ExplicitRegistrationDispatcherUtils','setImmediate'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('Dispatcher_DEPRECATED'));i=h&&h.prototype;function j(k){var l=k.strict;i.constructor.call(this);this.$ExplicitRegistrationDispatcher4=l;this.$ExplicitRegistrationDispatcher1={};this.$ExplicitRegistrationDispatcher2={};this.$ExplicitRegistrationDispatcher3={};}j.prototype.explicitlyRegisterStore=function(k){var l=k.getDispatchToken(),m=this.$ExplicitRegistrationDispatcher2[l];this.$ExplicitRegistrationDispatcher3[m]=true;};j.prototype.explicitlyRegisterStores=function(k){k.forEach(function(l){return this.explicitlyRegisterStore(l);}.bind(this));};j.prototype.register=function(k,l){var m=this.__genID(l);this.$ExplicitRegistrationDispatcher1[m]=k;this.$ExplicitRegistrationDispatcher3[m]=false;var n=i.register.call(this,this.$ExplicitRegistrationDispatcher6.bind(this,m),m);this.$ExplicitRegistrationDispatcher2[n]=m;return n;};j.prototype.$ExplicitRegistrationDispatcher6=function(k,l){if(this.$ExplicitRegistrationDispatcher3[k]||!this.$ExplicitRegistrationDispatcher4)this.__invokeCallback(k,this.$ExplicitRegistrationDispatcher1[k],l);};f.exports=j;},null);
__d('ChatDispatcher',['ExplicitRegistrationDispatcher'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(){h.apply(this,arguments);}f.exports=new j({strict:false});},null);
__d('ChatReliabilityTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ChatReliabilityLoggerConfig',this.$ChatReliabilityTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ChatReliabilityLoggerConfig',this.$ChatReliabilityTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ChatReliabilityTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ChatReliabilityTypedLogger1=babelHelpers['extends']({},this.$ChatReliabilityTypedLogger1,j);return this;};h.prototype.setEvent=function(j){this.$ChatReliabilityTypedLogger1.event=j;return this;};h.prototype.setEventData=function(j){this.$ChatReliabilityTypedLogger1.event_data=j;return this;};var i={event:true,event_data:true};f.exports=h;},null);
__d('ChatReliabilityInstrumentation',['ChatReliabilityEvents','ChatReliabilityTypedLogger','MercuryConfig'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=function(event,j){if(!c('MercuryConfig').EnableReliabilityLogging)return;new (c('ChatReliabilityTypedLogger'))().setEvent(event).setEventData(j).log();},i={logERROR:function(j){h(c('ChatReliabilityEvents').ERROR,j);},logCHANNEL_DISCONNECT:function(j){h(c('ChatReliabilityEvents').CHANNEL_DISCONNECT,j);},logCHANNEL_CONNECT:function(j){h(c('ChatReliabilityEvents').CHANNEL_CONNECT,j);},logCHANNEL_HISTORY_INVALID:function(j){h(c('ChatReliabilityEvents').CHANNEL_HISTORY_INVALID,j);},logMESSAGE_RECEIVED:function(j){h(c('ChatReliabilityEvents').MESSAGE_RECEIVED,j);},logCHANNEL_STALLED:function(j){h(c('ChatReliabilityEvents').CHANNEL_STALLED,j);},logCHANNEL_INIT:function(j){h(c('ChatReliabilityEvents').CHANNEL_INIT,j);},logCHANNEL_NOCONFIG:function(j){h(c('ChatReliabilityEvents').CHANNEL_NOCONFIG,j);}};f.exports=i;},null);
__d('PresenceStatusActionTypes',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=c('keyMirror')({AVAILABILITY_CHANGED:null});},null);
__d("TypingStates",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={INACTIVE:0,TYPING:1,QUITTING:2};f.exports=h;},null);
__d('AvailableList',['Arbiter','ArbiterMixin','AsyncRequest','AvailableListConstants','BanzaiODS','Bootloader','ChannelConstants','ChatConfig','ChatDispatcher','ChatproxyPresence','ChatReliabilityInstrumentation','ChatVisibility','CurrentUser','ErrorUtils','JSLogger','LastActiveTimes','PresencePrivacy','PresenceStatus','PresenceStatusActionTypes','Run','ServerTime','ShortProfiles','TypingStates','debounceAcrossTransitions','emptyFunction','requireWeak'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();c('BanzaiODS').setEntitySample('presence',.0001);var h=babelHelpers['extends']({},c('AvailableListConstants'),c('ArbiterMixin'));h.subscribe([c('AvailableListConstants').ON_AVAILABILITY_CHANGED,c('AvailableListConstants').ON_UPDATE_ERROR],function(p,q){c('Arbiter').inform(p,q);});var i=c('debounceAcrossTransitions')(function(){h.inform(c('AvailableListConstants').ON_AVAILABILITY_CHANGED);c('ChatDispatcher').dispatch({type:c('PresenceStatusActionTypes').AVAILABILITY_CHANGED});},0);function j(p,q,r,s,t){if(p===c('CurrentUser').getID())return;var u=c('PresenceStatus').set(p,q,r,s,t);if(u){var v=c('debounceAcrossTransitions')(function(){h.inform(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,p);c('ChatDispatcher').dispatch({type:c('PresenceStatusActionTypes').AVAILABILITY_CHANGED,id:p});},0);v();}}function k(p){var q=p.payload.availability||{};for(var r in q)j(r&&r.toString(),q[r].a,true,'mercury_tabs',q[r].c);}function l(p){var q=h.getDebugInfo(p),r=q.presence==c('AvailableListConstants').ACTIVE;new (c('AsyncRequest'))('/ajax/mercury/tabs_presence.php').setData({target_id:p,to_online:r,presence_source:q.overlaySource,presence_time:q.overlayTime}).setHandler(k).setErrorHandler(c('emptyFunction')).setAllowCrossPageTransition(true).send();}function m(p,q){q.chat_config=c('ChatConfig').getDebugInfo();q.available_list_debug_info={count:c('PresenceStatus').getOnlineIDs().length};}var n=undefined;try{n=new (c('ChatproxyPresence'))(function(event){h.inform(event);});n.subscribe();}catch(o){c('ErrorUtils').reportError&&c('ErrorUtils').reportError(o,false);c('ChatReliabilityInstrumentation').logERROR(o.getMessage());}Object.assign(h,{getChatproxyPresenceObject:function(){return n;},get:function(p){return c('PresenceStatus').get(p);},updateForID:function(p){l(p);if(c('PresencePrivacy').getVisibility()==c('PresencePrivacy').ONLINE)c('Run').onAfterLoad(function(){return (c('Bootloader').loadModules(["ChannelManager","ChannelTransport"],function(q,r){r.sendAdditionalBuddyRequest(q.getCompleteConfig(),p);},'AvailableList'));});},getWebChatNotification:function(){return n&&n.getWebChatNotification();},isReady:function(){return !!n;},set:function(p,q,r,s){j(p,q,true,r,s);},getDebugInfo:function(p){var q=c('PresenceStatus').getDebugInfo(p),r=c('ShortProfiles').getNow(p);if(r)q.name=r.name;return q;}});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,m);c('PresencePrivacy').subscribe(['privacy-changed','privacy-availability-changed','privacy-user-presence-response'],i);c('requireWeak')('ChannelConnection',function(p){return (p.subscribe([p.CONNECTED,p.RECONNECTING,p.SHUTDOWN,p.MUTE_WARNING,p.UNMUTE_WARNING],i));});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('buddylist_overlay'),function(p,q){var r={},s=q.obj.overlay;for(var t in s){h.set(t,s[t].a,s[t].s||'channel',s[t].vc);if(s[t].la)r[t]=s[t].la;}c('LastActiveTimes').update(r);});c('Arbiter').subscribe([c('ChannelConstants').getArbiterType('typ'),c('ChannelConstants').getArbiterType('ttyp')],function(p,q){var r=q.obj;if(r.st===c('TypingStates').TYPING){var s=r.from;if(c('ChatVisibility').isOnline()){c('BanzaiODS').bumpEntityKey('presence','stale_presence_check_typing');var t=c('PresenceStatus').get(s);if(t!=c('AvailableListConstants').ACTIVE){var u=c('LastActiveTimes').get(s)*1000,v=c('ServerTime').get();if(!u){c('BanzaiODS').bumpEntityKey('presence','no_detailed_presence_typing');}else if(v-u>5*60*1000){var w='stale_presence_typing',x=v-u;if(x<10*60*1000){w+='600';}else if(x<60*60*1000)w+='3600';c('BanzaiODS').bumpEntityKey('presence',w);}}}h.set(s&&s.toString(),c('AvailableListConstants').ACTIVE,'channel-typing');}});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('messaging'),function(p,q){if(!c('ChatVisibility').isOnline())return;var r=q.obj;if(r.message&&r.message.timestamp&&r.message.sender_fbid){var s=c('ServerTime').get(),t=r.message.timestamp;if(s-t<2*60*1000){c('BanzaiODS').bumpEntityKey('presence','stale_presence_check');var u=r.message.sender_fbid,v=c('PresenceStatus').get(u);if(v==c('AvailableListConstants').ACTIVE)return;var w=c('LastActiveTimes').get(u)*1000;if(!w){c('BanzaiODS').bumpEntityKey('presence','no_detailed_presence');}else if(t-w>5*60*1000){var x='stale_presence',y=t-w;if(y<10*60*1000){x+='600';}else if(y<60*60*1000)x+='3600';c('BanzaiODS').bumpEntityKey('presence',x);}}}});f.exports=h;},null);
__d('StoreAndPropBasedStateMixin',['invariant','StoreBasedStateMixinHelper','setImmediate'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return {getInitialState:function(){return this.constructor.calculateState(this.props);},componentWillMount:function(){!this.constructor.calculateState?h(0):void 0;this._recalculateStateID=null;var m=function(){if(this.isMounted())this.setState(this.constructor.calculateState(this.props));this._recalculateStateID=null;}.bind(this);this._mixin=new (c('StoreBasedStateMixinHelper'))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c('setImmediate')(m);}.bind(this));},componentWillReceiveProps:function(m){this.setState(this.constructor.calculateState(m));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);f.exports=i;},null);
__d('ReactComponentRenderer',['React','ReactDOM','warning'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){this.klass=i;this.container=j;this.props={};this.component=null;}h.prototype.replaceProps=function(i,j){this.props={};this.setProps(i,j);};h.prototype.setProps=function(i,j){if(this.klass==null)return;Object.assign(this.props,i);var k=c('React').createElement(this.klass,this.props);this.component=c('ReactDOM').render(k,this.container,j);};h.prototype.unmount=function(){c('ReactDOM').unmountComponentAtNode(this.container);this.klass=null;};f.exports=h;},null);
__d('ChatFlyoutPlaceholder.react',['React','XUISpinner.react'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={padding:'30px',textAlign:'center'},i=function(){return (c('React').createElement('div',{style:h},c('React').createElement(c('XUISpinner.react'),{size:'large'})));};f.exports=i;},null);
__d('StickersDispatcher',['Dispatcher_DEPRECATED','StickerConstants'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=Object.assign(new (c('Dispatcher_DEPRECATED'))(),{_handleUpdate:function(i,j){var k=babelHelpers['extends']({payloadSource:i},j);this.dispatch(k);},handleUpdateFromViewActions:function(i){this._handleUpdate(c('StickerConstants').PayloadSource.VIEW_ACTION,i);}});f.exports=h;},null);
__d('StickerActions',['BanzaiLogger','StickersDispatcher','keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({ADD_PACK:null,CLICKED_STICKER_IN_THREAD:null,HIDE_TRAY:null,REMOVE_PACK:null,REPLACE_STICKER_STATE:null,RESET_NUM_NEW_PACKS:null,SELECT_PACK:null,SELECT_STORE_PACK:null,SHOW_TRAY:null,UPDATE_TRAY_DATA:null,TRAY_DATA_READY:null,SUBSCRIBE_ASSOCIATED_PAGE:null}),i={Types:h,addPack:function(j){c('StickersDispatcher').dispatch({type:h.ADD_PACK,packID:j});},removePack:function(j){c('StickersDispatcher').dispatch({type:h.REMOVE_PACK,packID:j});},selectPack:function(j,k){if(!k)c('BanzaiLogger').log('StickersLoggerConfig',{event:'select_pack',packid:j});c('StickersDispatcher').dispatch({type:h.SELECT_PACK,packID:j});},selectStorePack:function(j){c('StickersDispatcher').dispatch({type:h.SELECT_STORE_PACK,packID:j});},resetNumNewPacks:function(){c('StickersDispatcher').dispatch({type:h.RESET_NUM_NEW_PACKS});},handleStickerClick:function(j,k){c('StickersDispatcher').dispatch({packID:j,threadID:k,type:i.Types.CLICKED_STICKER_IN_THREAD});},showStickerTray:function(j){c('StickersDispatcher').dispatch({type:i.Types.SHOW_TRAY,threadID:j});},hideStickerTray:function(){c('StickersDispatcher').dispatch({type:i.Types.HIDE_TRAY});},updateTrayData:function(){c('StickersDispatcher').dispatch({type:i.Types.UPDATE_TRAY_DATA});},loadedTrayData:function(){c('StickersDispatcher').dispatch({type:i.Types.TRAY_DATA_READY});},subscribeAssociatedPage:function(j,k){c('StickersDispatcher').dispatch({type:i.Types.SUBSCRIBE_ASSOCIATED_PAGE,packID:j,callback:k});}};f.exports=i;},null);
__d('ContextualLayerAutoFlipHorizontal',['ContextualLayerAutoFlip'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('ContextualLayerAutoFlip'));i=h&&h.prototype;j.prototype.getValidPositions=function(k){'use strict';return [k.getPosition()];};function j(){'use strict';h.apply(this,arguments);}f.exports=j;},null);
__d('StickerContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','MercuryConfig','ReactAbstractContextualDialog','ReactLayer'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=7,j=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:i,length:16}}}));j.WIDTH={NORMAL:312,WIDE:400};f.exports=j;},null);
__d('Dcode',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h,i={},j={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var l=[];for(var m in j){i[j[m]]=m;l.push(j[m]);}l.reverse();h=new RegExp(l.join("|"),'g');})();var k={encode:function(l){return encodeURIComponent(l).replace(/([_A-Z])|%../g,function(m,n){return n?'%'+n.charCodeAt(0).toString(16):m;}).toLowerCase().replace(h,function(m){return i[m];});},decode:function(l){return decodeURIComponent(l.replace(/[_A-Z]/g,function(m){return j[m];}));}};f.exports=k;},null);
__d('PresenceCookieManager',['Cookie','CurrentUser','Dcode','ErrorUtils','JSLogger','PresenceInitialData','PresenceUtil','URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('PresenceInitialData').cookieVersion,i='presence',j={},k=null,l=null,m=c('JSLogger').create('presence_cookie');function n(){try{var r=c('Cookie').get(i);if(k!==r){k=r;l=null;if(r&&r.charAt(0)=='E')r=c('Dcode').decode(r.substring(1));if(r)l=JSON.parse(r);}if(l){if(l.user&&l.user!==c('CurrentUser').getID())return null;if(l.v!==h)return null;return l;}}catch(q){m.warn('getcookie_error',q);}return null;}function o(){return parseInt(Date.now()/1000,10);}var p={register:function(q,r){j[q]=r;},store:function(){var q=n();if(q&&q.v&&h<q.v){m.debug('stale_cookie',h);return;}var r={v:h,time:o(),user:c('CurrentUser').getID()};for(var s in j)r[s]=c('ErrorUtils').applyWithGuard(j[s],j,[q&&q[s]],function(w){w.presence_subcookie=s;});var t='E'+c('Dcode').encode(JSON.stringify(r));if(c('PresenceUtil').hasUserCookie()){var u=t.length;if(u>1024)m.warn('big_cookie',u);var v=c('URI').getRequestURI(false).isSecure()&&!!c('Cookie').get('csm');c('Cookie').set(i,t,null,null,v);}},clear:function(){c('Cookie').clear(i);},getSubCookie:function(q){var r=n();if(!r)return null;return r[q];}};f.exports=p;},null);
__d('PresenceState',['Arbiter','ErrorUtils','JSLogger','PresenceCookieManager','debounceAcrossTransitions','setIntervalAcrossTransitions','PresenceInitialData'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('PresenceInitialData').cookiePollInterval||2000,i=c('PresenceInitialData').shouldSuppress||false,j=[],k=[],l=null,m=null,n=0,o=null,p=0,q=['sb2','t2','lm2','uct2','tr','tw','at','wml'],r=c('JSLogger').create('presence_state');function s(){return c('PresenceCookieManager').getSubCookie('state');}function t(){n=Date.now();c('PresenceCookieManager').store();x(m);}var u=c('debounceAcrossTransitions')(t,0);function v(ca){if(typeof ca=='undefined'||isNaN(ca)||ca==Number.POSITIVE_INFINITY||ca==Number.NEGATIVE_INFINITY)ca=0;return ca;}function w(ca){var da={};if(ca){q.forEach(function(ga){da[ga]=ca[ga];});if(n<ca.ut)r.error('new_cookie',{cookie_time:ca.ut,local_time:n});}da.ut=n;for(var ea=0,fa=j.length;ea<fa;ea++)c('ErrorUtils').applyWithGuard(j[ea],null,[da]);m=da;return m;}function x(ca){p++;n=v(ca.ut);if(!l)l=c('setIntervalAcrossTransitions')(aa,h);m=ca;if(o===null)o=ca;for(var da=0,ea=k.length;da<ea;da++)c('ErrorUtils').applyWithGuard(k[da],null,[ca]);p--;}function y(ca){if(ca&&ca.ut)if(n<ca.ut){return true;}else if(ca.ut<n)r.error('old_cookie',{cookie_time:ca.ut,local_time:n});return false;}function z(){var ca=s();if(y(ca))m=ca;return m;}function aa(){var ca=s();if(y(ca))x(ca);}c('PresenceCookieManager').register('state',w);c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ca,da){da.presence_state={initial:babelHelpers['extends']({},o),state:babelHelpers['extends']({},m),update_time:n,sync_paused:p,poll_time:h};});(function(){var ca=z();if(ca){x(ca);}else{r.debug('no_cookie_initial');x(w());return;}})();var ba={doSync:function(ca){if(p)return;if(ca){t();}else u();},registerStateStorer:function(ca){j.push(ca);},registerStateLoader:function(ca){k.push(ca);},get:function(){return z();},getInitial:function(){return o;},shouldSuppress:function(){return i;},verifyNumber:v};f.exports=ba;},null);
__d("XMNStickerAssociatedPageSubscriptionController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/stickers\/subscription\/",{pack_id:{type:"FBID"}});},null);
__d("XStickerPackImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int",defaultValue:50}});},null);
__d("XStickerQueryImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/query\/images\/",{query:{type:"String",required:true},sticker_interface:{type:"String"}});},null);
__d("XStickerStateInitialDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/store\/",{});},null);
__d("XStickersAddPackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/addpack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},is_promoted:{type:"Bool",defaultValue:false},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d("XStickersRemovePackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d('StickerServerRequests',['Promise','AsyncRequest','XMNStickerAssociatedPageSubscriptionController','XStickerPackImagesController','XStickersAddPackController','XStickersRemovePackController','XStickerStateInitialDataController','XStickerStatePackDataController','XStickerStateStoreDataController','XStickerQueryImagesController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={addPack:function(j,k,l){var m=c('XStickersAddPackController').getURIBuilder().setInt('pack_id',j).setBool('is_promoted',k).getURI();new (c('AsyncRequest'))(m).setHandler(function(n){return l(n.payload);}).send();},removePack:function(j,k){var l=c('XStickersRemovePackController').getURIBuilder().setInt('pack_id',j).getURI();new (c('AsyncRequest'))(l).setHandler(function(m){return k(m.payload);}).send();},getStickersForPack:function(j,k){var l=c('XStickerPackImagesController').getURIBuilder().setInt('pack_id',j).setInt('sticker_size',k).getURI();return new (c('Promise'))(function(m,n){return (new (c('AsyncRequest'))().setURI(l).setMethod('GET').setReadOnly(true).setHandler(function(o){return m(o.payload);}).send());});},getStickersForQuery:function(j,k,l){new (c('AsyncRequest'))().setURI(c('XStickerQueryImagesController').getURIBuilder().setString('query',j).setString('sticker_interface',k).getURI()).setMethod('GET').setReadOnly(true).setHandler(function(m){return l(m);}).send();},fetchTrayData:function(j){return i(c('XStickerStateInitialDataController').getURIBuilder().getURI(),j,true);},fetchStoreData:function(j){return i(c('XStickerStateStoreDataController').getURIBuilder().getURI(),j);},fetchPackData:function(j,k){return i(c('XStickerStatePackDataController').getURIBuilder().setInt('pack_id',j).getURI(),k);},subscribeAssociatedPage:function(j,k){var l=c('XMNStickerAssociatedPageSubscriptionController').getURIBuilder().setFBID('pack_id',j).getURI();new (c('AsyncRequest'))(l).setHandler(function(m){return k();}).send();}};function i(j,k,l){return new (c('Promise'))(function(m,n){return (new (c('AsyncRequest'))(j).setHandler(function(o){return m(o.getPayload());}).setAllowCrossPageTransition(l).send());}).then(k);}f.exports=h;},null);
__d('StickerImages',['StickerServerRequests'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={},i={},j={requestStickersForPack:function(k,l,m){if(!k)return;if(!i[k]){i[k]=c('StickerServerRequests').getStickersForPack(k,l);i[k].then(function(n){n.forEach(function(o){return this.cacheSticker(o);}.bind(this));}.bind(this));}i[k].then(function(n){return m(n);});},cacheSticker:function(k){h[k.id]=k;},getSticker:function(k){return h[k];}};f.exports=j;},null);
__d('StickerState',['ImmutableObject','PresenceState','StickerActions','StickerConstants','StickerImages','StickerServerRequests'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={},i=void 0,j=void 0,k=void 0,l=null,m=0,n={},o=[],p=[],q=[],r=null,s=null,t=c('PresenceState').get();if(t)r=t.tray_pack_id;var u={onTrayDataReady:function(w){if(!j)j=c('StickerServerRequests').fetchTrayData(function(x){o=x.packs.map(function(y){return v(y);});k=x.mru;m=x.num_new_packs;q=x.tags;});j.then(function(){w();c('StickerActions').loadedTrayData();});},onStoreDataReady:function(w){if(!i)i=c('StickerServerRequests').fetchStoreData(function(x){p=x.packs.map(function(y){return v(y);});});i.then(w);},onPackDataReady:function(w,x){if(!h[w])h[w]=c('StickerServerRequests').fetchPackData(w,function(y){v(y);});h[w].then(x);},getPacksInTrayAllInterfaces:function(){return o;},getPacksInTray:function(){var w=[],x=void 0;for(var y=0;y<o.length;y++)if(o[y].id==c('StickerConstants').EMOTICON_PACK_ID){x=o[y];}else if(o[y].isMessengerCapable)w.push(o[y]);x&&w.push(x);return w;},getPacksInCommentsTray:function(){var w=[],x=[],y=void 0;for(var z=0;z<o.length;z++)if(o[z].id==c('StickerConstants').EMOTICON_PACK_ID){y=o[z];}else if(o[z].isCommentsCapable){w.push(o[z]);}else x.push(o[z]);var aa=w.concat(x);if(y)aa.push(y);return aa;},getPacksInComposerTray:function(){return o.filter(function(w){return w.isComposerCapable;});},getPacksInFramesTray:function(){return o.filter(function(w){return w.isFramePack;});},getPackIDsInTray:function(){return o.map(function(w){return w.id;});},getPacksInStore:function(){return p.filter(function(w){return w.isMessengerCapable;});},getComposerPacksInStore:function(){return p.filter(function(w){return w.isComposerCapable;});},getPack:function(w){return n[w];},getNumNewPacks:function(){return m;},getFeaturedTags:function(){return q;},resetNumNewPacks:function(){m=0;},addMRUPack:function(){if(k){this._addPackToTray(k);k=null;}},addPack:function(w){var x=false;if(n[w])x=n[w].isPromoted;c('StickerServerRequests').addPack(w,x,function(y){this._addPackToTray(y);}.bind(this));},removePack:function(w){c('StickerServerRequests').removePack(w,function(x){o=o.filter(function(y){return y.id!==x;});n[x]=c('ImmutableObject').set(n[x],{isInTray:false});p=p.map(function(y){return n[y.id];});c('StickerActions').updateTrayData();});},setTrayPackID:function(w){r=w;c('PresenceState').doSync();},getTrayPackID:function(w){if(w&&w.length>0&&!w.some(function(x){return x.id===r;})){return w[0].id;}else return r;},setStorePackID:function(w){s=w;},getStorePackID:function(){return s;},subscribeAssociatedPage:function(w,x){c('StickerServerRequests').subscribeAssociatedPage(w,function(){n[w]=c('ImmutableObject').set(n[w],{isAssociatedPageSubscribed:true});p=p.map(function(y){return n[y.id];});c('StickerActions').updateTrayData();x();});},_addPackToTray:function(w,x){v(w);n[w.id]=c('ImmutableObject').set(n[w.id],{isPurchased:!x,isInTray:true});var y=o.filter(function(aa){return aa.id===w.id;}).length>0;if(!y){var z=void 0;if(!x){z=o.filter(function(aa){return aa.isMRU||aa.isSearch;}).length;}else z=o.filter(function(aa){return aa.id!==c('StickerConstants').EMOTICON_PACK_ID;}).length;o.splice(z,0,n[w.id]);}p=p.map(function(aa){return n[aa.id];});c('StickerActions').updateTrayData();},_addRecentlyUsedSticker:function(w){for(var x=0;x<l.length;++x)if(l[x].id===w.id){l.splice(x,1);break;}l.unshift(w);},getMRUStickerPack:function(w){if(!l)l=w;return l;},updateRecentlyUsed:function(w){if(!l){this.addMRUPack();return;}this._addRecentlyUsedSticker(c('StickerImages').getSticker(w));}};c('PresenceState').registerStateStorer(function(w){w.tray_pack_id=r;});function v(w){var x=w.id;if(!n[x]){return n[x]=new (c('ImmutableObject'))(w);}else return n[x]=c('ImmutableObject').set(n[x],w);}f.exports=u;},null);
__d('AbstractDialogFitHeight',['csx','cx','CSS','DOM','Event','Style','SubscriptionsHandler','Vector','throttle'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=450,k=100,l=67,m=67;function n(o){'use strict';this.$AbstractDialogFitHeight1=o;}n.prototype.enable=function(){'use strict';this.$AbstractDialogFitHeight2=new (c('SubscriptionsHandler'))();this.$AbstractDialogFitHeight2.addSubscriptions(this.$AbstractDialogFitHeight1.subscribe('beforeshow',this.$AbstractDialogFitHeight3.bind(this)),c('Event').listen(window,'resize',c('throttle')(this.$AbstractDialogFitHeight3.bind(this))));this.$AbstractDialogFitHeight4=c('DOM').find(this.$AbstractDialogFitHeight1.getRoot(),"._4-i2");c('CSS').addClass(this.$AbstractDialogFitHeight4,"_5pfh");this.$AbstractDialogFitHeight5=k;if(c('DOM').scry(this.$AbstractDialogFitHeight1.getRoot(),"._4-i0").length)this.$AbstractDialogFitHeight5+=l;if(c('DOM').scry(this.$AbstractDialogFitHeight1.getRoot(),"._5a8u").length)this.$AbstractDialogFitHeight5+=m;};n.prototype.disable=function(){'use strict';this.$AbstractDialogFitHeight2.release();this.$AbstractDialogFitHeight2=null;c('CSS').removeClass(this.$AbstractDialogFitHeight4,"_5pfh");};n.prototype.$AbstractDialogFitHeight3=function(){'use strict';var o=c('Vector').getViewportDimensions().y,p=o-this.$AbstractDialogFitHeight5;c('Style').set(this.$AbstractDialogFitHeight4,this.getHeightProperty(),Math.max(j,p)+'px');this.$AbstractDialogFitHeight1.updatePosition();};f.exports=n;},null);
__d('DialogFitHeight',['AbstractDialogFitHeight'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('AbstractDialogFitHeight'));i=h&&h.prototype;j.prototype.getHeightProperty=function(){'use strict';return 'height';};function j(){'use strict';h.apply(this,arguments);}f.exports=j;},null);
__d('StickerStoreController',['cx','Bootloader','DialogFitHeight','DOM','LayerAutoFocus','LayerFadeOnHide','LayerHideOnEscape','React','ReactComponentRenderer','StickerActions','XUIDialog.react','XUIDialogBody.react','XUISpinner.react','isSocialPlugin','requestAnimationFrame'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=688,k=320,l=null,m=c('React').createClass({displayName:'StoreLayer',propTypes:{isComposer:i.bool,shown:i.bool},getDefaultProps:function(){return {isComposer:false,shown:false};},getInitialState:function(){return {renderStore:function(){return (c('React').createElement('div',{className:"_5r5e"},c('React').createElement(c('XUISpinner.react'),{background:'light',size:'large'})));}};},componentDidMount:function(){c('Bootloader').loadModules(["StickerStore.react"],function(p){this.setState({renderStore:function(){return (c('React').createElement(p,{isComposer:this.props.isComposer,shown:this.props.shown}));}.bind(this)});}.bind(this),'StickerStoreController');},_onToggle:function(p){c('requestAnimationFrame')(function(){if(l)l.setProps({shown:p});});},render:function(){var p=c('isSocialPlugin')()&&document.body.offsetWidth<j?k:j;return (c('React').createElement(c('XUIDialog.react'),{behaviors:{DialogFitHeight:c('DialogFitHeight'),LayerAutoFocus:c('LayerAutoFocus'),LayerFadeOnHide:c('LayerFadeOnHide'),LayerHideOnEscape:c('LayerHideOnEscape')},onToggle:this._onToggle,shown:this.props.shown,width:p},c('React').createElement(c('XUIDialogBody.react'),{className:"_5rq- autofocus"},this.state.renderStore())));}});function n(p){var q=c('DOM').create('div');c('DOM').appendContent(document.body,q);l=new (c('ReactComponentRenderer'))(m,q);l.setProps({isComposer:p,shown:true});}var o={showStore:function(p,q){if(!l){n(!!q);}else l.setProps({shown:true,isComposer:!!q});c('StickerActions').selectStorePack(p);}};f.exports=o;},null);
__d('StickerStateStore',['FluxStore','StickerActions','StickerInterfaces','StickersDispatcher','StickerState','StickerStoreController','arrayContains','emptyFunction'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('StickersDispatcher'));this.$StickerStateStore3=false;}j.prototype.getState=function(k){var l=null;if(k===c('StickerInterfaces').COMPOSER){l=c('StickerState').getPacksInComposerTray();}else if(k===c('StickerInterfaces').COMMENTS){l=c('StickerState').getPacksInCommentsTray();}else if(k===c('StickerInterfaces').FRAMES){l=c('StickerState').getPacksInFramesTray();}else l=c('StickerState').getPacksInTray();return {showTray:this.$StickerStateStore1,storePackID:c('StickerState').getStorePackID(),packID:c('StickerState').getTrayPackID(l),trayPacks:l,numNewPacks:c('StickerState').getNumNewPacks(),threadID:this.$StickerStateStore2,trayDataReady:this.$StickerStateStore3};};j.prototype.isPackInTray=function(k){if(!this.$StickerStateStore3)c('StickerState').onTrayDataReady(c('emptyFunction'));var l=c('StickerState').getPacksInTrayAllInterfaces();return l.some(function(m){return m.id===k;});};j.prototype.isPackPageSubscribed=function(k){if(!this.$StickerStateStore3)c('StickerState').onTrayDataReady(c('emptyFunction'));var l=c('StickerState').getPacksInTrayAllInterfaces();return l.some(function(m){return m.id===k&&m.isAssociatedPageSubscribed;});};j.prototype.__onDispatch=function(k){var l=c('StickerActions').Types;switch(k.type){case l.REPLACE_STICKER_STATE:this.$StickerStateStore1=!!k.showTray;break;case l.SHOW_TRAY:this.$StickerStateStore1=true;this.$StickerStateStore2=k.threadID;break;case l.HIDE_TRAY:this.$StickerStateStore1=false;break;case l.CLICKED_STICKER_IN_THREAD:c('StickerState').onTrayDataReady(function(){if(c('arrayContains')(c('StickerState').getPackIDsInTray(),k.packID)){c('StickerState').setTrayPackID(k.packID);this.$StickerStateStore1=true;this.$StickerStateStore2=k.threadID;}else{this.$StickerStateStore1=false;c('StickerStoreController').showStore(k.packID);}}.bind(this));break;case l.SELECT_PACK:c('StickerState').setTrayPackID(k.packID);break;case l.SELECT_STORE_PACK:c('StickerState').setStorePackID(k.packID);break;case l.RESET_NUM_NEW_PACKS:c('StickerState').resetNumNewPacks();break;case l.ADD_PACK:c('StickerState').addPack(k.packID);break;case l.REMOVE_PACK:c('StickerState').removePack(k.packID);break;case l.UPDATE_TRAY_DATA:break;case l.TRAY_DATA_READY:this.$StickerStateStore3=true;break;case l.SUBSCRIBE_ASSOCIATED_PAGE:c('StickerState').subscribeAssociatedPage(k.packID,k.callback);break;}this.__emitChange();};f.exports=new j();},null);
__d('ChatStickerButton.react',['cx','fbt','BootloadOnRender.react','ChatFlyoutPlaceholder.react','JSResource','LazyComponent.react','Link.react','MercuryConfig','React','ReactLayeredComponentMixin','StickerActions','StickerContextualDialog.react','StickerStateStore','StoreAndPropBasedStateMixin','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatStickerButton',_clickGuard:false,mixins:[c('ReactLayeredComponentMixin'),c('StoreAndPropBasedStateMixin')(c('StickerStateStore'))],propTypes:{className:j.string,ContextualDialogClass:j.func.isRequired,disabled:j.bool,flyoutClassName:j.string,flyoutWidth:j.number,getInput:j.func,onLoad:j.func,onStickerSelect:j.func.isRequired,onEmoticonSelect:j.func.isRequired,onFlyoutShown:j.func,onFlyoutHidden:j.func,threadID:j.string},statics:{calculateState:function(m){var n=c('StickerStateStore').getState();return {shown:n.showTray&&m.threadID===n.threadID};}},getDefaultProps:function(){return {ContextualDialogClass:c('StickerContextualDialog.react'),disabled:false,flyoutWidth:k,onStickerSelect:c('emptyFunction'),onEmoticonSelect:c('emptyFunction')};},componentDidMount:function(){this.props.onLoad&&this.props.onLoad(this);},componentDidUpdate:function(m,n){var o=this.state&&this.state.shown;if(o!==n.shown)if(o){this.props.onFlyoutShown&&this.props.onFlyoutShown();}else this.props.onFlyoutHidden&&this.props.onFlyoutHidden();},componentWillUnmount:function(){if(this.state.shown)this._hideFlyout();},shouldComponentUpdate:function(m,n){return this.props.disabled!==m.disabled||this.state.shown!==n.shown;},render:function(){var m=c('MercuryConfig').MessengerNewEmojiGK?i._("Choose a sticker"):i._("Choose a sticker or emoticon");return (c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onClick:this.showFlyout,onMouseDown:this._prepareForClick,role:'button',title:m,ref:'link'}));},renderLayers:function(){if(!this.state.shown)return {};var m=this.props.ContextualDialogClass;return {contextualDialog:c('React').createElement(m,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBeforeHide:this._handleBeforeHide,onBlur:this._hideFlyout,position:'above',shown:this.state.shown,width:this.props.flyoutWidth},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{className:this.props.flyoutClassName,onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,shown:this.state.shown}),loader:c('JSResource')('StickersFlyout.react').__setRef('ChatStickerButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(m){m&&m.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}c('StickerActions').showStickerTray(this.props.threadID);},_handleBeforeHide:function(){if(this.state.shown){this._hideFlyout();return false;}},_hideFlyout:function(){var m=this.props.getInput&&this.props.getInput();m&&m.focus&&m.focus();c('StickerActions').hideStickerTray();},_handleStickerSelected:function(m){this.props.onStickerSelect(m);},_handleEmoticonSelected:function(m){this._hideFlyout();this.props.onEmoticonSelect(m);}});f.exports=l;},null);
__d('FBRTCDispatcher',['Dispatcher_DEPRECATED'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new (c('Dispatcher_DEPRECATED'))();},null);